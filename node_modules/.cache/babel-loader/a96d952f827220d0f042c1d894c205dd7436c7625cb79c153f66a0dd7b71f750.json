{"ast":null,"code":"var _ = require(\"underscore\");\nexports.readNumberingXml = readNumberingXml;\nexports.Numbering = Numbering;\nexports.defaultNumbering = new Numbering({}, {});\nfunction Numbering(nums, abstractNums, styles) {\n  var allLevels = _.flatten(_.values(abstractNums).map(function (abstractNum) {\n    return _.values(abstractNum.levels);\n  }));\n  var levelsByParagraphStyleId = _.indexBy(allLevels.filter(function (level) {\n    return level.paragraphStyleId != null;\n  }), \"paragraphStyleId\");\n  function findLevel(numId, level) {\n    var num = nums[numId];\n    if (num) {\n      var abstractNum = abstractNums[num.abstractNumId];\n      if (!abstractNum) {\n        return null;\n      } else if (abstractNum.numStyleLink == null) {\n        return abstractNums[num.abstractNumId].levels[level];\n      } else {\n        var style = styles.findNumberingStyleById(abstractNum.numStyleLink);\n        return findLevel(style.numId, level);\n      }\n    } else {\n      return null;\n    }\n  }\n  function findLevelByParagraphStyleId(styleId) {\n    return levelsByParagraphStyleId[styleId] || null;\n  }\n  return {\n    findLevel: findLevel,\n    findLevelByParagraphStyleId: findLevelByParagraphStyleId\n  };\n}\nfunction readNumberingXml(root, options) {\n  if (!options || !options.styles) {\n    throw new Error(\"styles is missing\");\n  }\n  var abstractNums = readAbstractNums(root);\n  var nums = readNums(root, abstractNums);\n  return new Numbering(nums, abstractNums, options.styles);\n}\nfunction readAbstractNums(root) {\n  var abstractNums = {};\n  root.getElementsByTagName(\"w:abstractNum\").forEach(function (element) {\n    var id = element.attributes[\"w:abstractNumId\"];\n    abstractNums[id] = readAbstractNum(element);\n  });\n  return abstractNums;\n}\nfunction readAbstractNum(element) {\n  var levels = {};\n  element.getElementsByTagName(\"w:lvl\").forEach(function (levelElement) {\n    var levelIndex = levelElement.attributes[\"w:ilvl\"];\n    var numFmt = levelElement.first(\"w:numFmt\").attributes[\"w:val\"];\n    var paragraphStyleId = levelElement.firstOrEmpty(\"w:pStyle\").attributes[\"w:val\"];\n    levels[levelIndex] = {\n      isOrdered: numFmt !== \"bullet\",\n      level: levelIndex,\n      paragraphStyleId: paragraphStyleId\n    };\n  });\n  var numStyleLink = element.firstOrEmpty(\"w:numStyleLink\").attributes[\"w:val\"];\n  return {\n    levels: levels,\n    numStyleLink: numStyleLink\n  };\n}\nfunction readNums(root) {\n  var nums = {};\n  root.getElementsByTagName(\"w:num\").forEach(function (element) {\n    var numId = element.attributes[\"w:numId\"];\n    var abstractNumId = element.first(\"w:abstractNumId\").attributes[\"w:val\"];\n    nums[numId] = {\n      abstractNumId: abstractNumId\n    };\n  });\n  return nums;\n}","map":{"version":3,"names":["_","require","exports","readNumberingXml","Numbering","defaultNumbering","nums","abstractNums","styles","allLevels","flatten","values","map","abstractNum","levels","levelsByParagraphStyleId","indexBy","filter","level","paragraphStyleId","findLevel","numId","num","abstractNumId","numStyleLink","style","findNumberingStyleById","findLevelByParagraphStyleId","styleId","root","options","Error","readAbstractNums","readNums","getElementsByTagName","forEach","element","id","attributes","readAbstractNum","levelElement","levelIndex","numFmt","first","firstOrEmpty","isOrdered"],"sources":["/Users/yashagrawal/Documents/Northwestern/Fall2023/CS338/InterviewPrep/node_modules/mammoth/lib/docx/numbering-xml.js"],"sourcesContent":["var _ = require(\"underscore\");\n\nexports.readNumberingXml = readNumberingXml;\nexports.Numbering = Numbering;\nexports.defaultNumbering = new Numbering({}, {});\n\nfunction Numbering(nums, abstractNums, styles) {\n    var allLevels = _.flatten(_.values(abstractNums).map(function(abstractNum) {\n        return _.values(abstractNum.levels);\n    }));\n\n    var levelsByParagraphStyleId = _.indexBy(\n        allLevels.filter(function(level) {\n            return level.paragraphStyleId != null;\n        }),\n        \"paragraphStyleId\"\n    );\n\n    function findLevel(numId, level) {\n        var num = nums[numId];\n        if (num) {\n            var abstractNum = abstractNums[num.abstractNumId];\n            if (!abstractNum) {\n                return null;\n            } else if (abstractNum.numStyleLink == null) {\n                return abstractNums[num.abstractNumId].levels[level];\n            } else {\n                var style = styles.findNumberingStyleById(abstractNum.numStyleLink);\n                return findLevel(style.numId, level);\n            }\n        } else {\n            return null;\n        }\n    }\n\n    function findLevelByParagraphStyleId(styleId) {\n        return levelsByParagraphStyleId[styleId] || null;\n    }\n\n    return {\n        findLevel: findLevel,\n        findLevelByParagraphStyleId: findLevelByParagraphStyleId\n    };\n}\n\nfunction readNumberingXml(root, options) {\n    if (!options || !options.styles) {\n        throw new Error(\"styles is missing\");\n    }\n\n    var abstractNums = readAbstractNums(root);\n    var nums = readNums(root, abstractNums);\n    return new Numbering(nums, abstractNums, options.styles);\n}\n\nfunction readAbstractNums(root) {\n    var abstractNums = {};\n    root.getElementsByTagName(\"w:abstractNum\").forEach(function(element) {\n        var id = element.attributes[\"w:abstractNumId\"];\n        abstractNums[id] = readAbstractNum(element);\n    });\n    return abstractNums;\n}\n\nfunction readAbstractNum(element) {\n    var levels = {};\n    element.getElementsByTagName(\"w:lvl\").forEach(function(levelElement) {\n        var levelIndex = levelElement.attributes[\"w:ilvl\"];\n        var numFmt = levelElement.first(\"w:numFmt\").attributes[\"w:val\"];\n        var paragraphStyleId = levelElement.firstOrEmpty(\"w:pStyle\").attributes[\"w:val\"];\n\n        levels[levelIndex] = {\n            isOrdered: numFmt !== \"bullet\",\n            level: levelIndex,\n            paragraphStyleId: paragraphStyleId\n        };\n    });\n\n    var numStyleLink = element.firstOrEmpty(\"w:numStyleLink\").attributes[\"w:val\"];\n\n    return {levels: levels, numStyleLink: numStyleLink};\n}\n\nfunction readNums(root) {\n    var nums = {};\n    root.getElementsByTagName(\"w:num\").forEach(function(element) {\n        var numId = element.attributes[\"w:numId\"];\n        var abstractNumId = element.first(\"w:abstractNumId\").attributes[\"w:val\"];\n        nums[numId] = {abstractNumId: abstractNumId};\n    });\n    return nums;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}