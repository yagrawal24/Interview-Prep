{"ast":null,"code":"var _ = require(\"underscore\");\nvar promises = require(\"../promises\");\nvar xml = require(\"../xml\");\nexports.read = read;\nexports.readXmlFromZipFile = readXmlFromZipFile;\nvar xmlNamespaceMap = {\n  \"http://schemas.openxmlformats.org/wordprocessingml/2006/main\": \"w\",\n  \"http://schemas.openxmlformats.org/officeDocument/2006/relationships\": \"r\",\n  \"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\": \"wp\",\n  \"http://schemas.openxmlformats.org/drawingml/2006/main\": \"a\",\n  \"http://schemas.openxmlformats.org/drawingml/2006/picture\": \"pic\",\n  \"http://schemas.openxmlformats.org/package/2006/content-types\": \"content-types\",\n  \"urn:schemas-microsoft-com:vml\": \"v\",\n  \"http://schemas.openxmlformats.org/markup-compatibility/2006\": \"mc\",\n  \"urn:schemas-microsoft-com:office:word\": \"office-word\"\n};\nfunction read(xmlString) {\n  return xml.readString(xmlString, xmlNamespaceMap).then(function (document) {\n    return collapseAlternateContent(document)[0];\n  });\n}\nfunction readXmlFromZipFile(docxFile, path) {\n  if (docxFile.exists(path)) {\n    return docxFile.read(path, \"utf-8\").then(stripUtf8Bom).then(read);\n  } else {\n    return promises.resolve(null);\n  }\n}\nfunction stripUtf8Bom(xmlString) {\n  return xmlString.replace(/^\\uFEFF/g, '');\n}\nfunction collapseAlternateContent(node) {\n  if (node.type === \"element\") {\n    if (node.name === \"mc:AlternateContent\") {\n      return node.first(\"mc:Fallback\").children;\n    } else {\n      node.children = _.flatten(node.children.map(collapseAlternateContent, true));\n      return [node];\n    }\n  } else {\n    return [node];\n  }\n}","map":{"version":3,"names":["_","require","promises","xml","exports","read","readXmlFromZipFile","xmlNamespaceMap","xmlString","readString","then","document","collapseAlternateContent","docxFile","path","exists","stripUtf8Bom","resolve","replace","node","type","name","first","children","flatten","map"],"sources":["/Users/yashagrawal/Documents/Northwestern/Fall2023/CS338/InterviewPrep/node_modules/mammoth/lib/docx/office-xml-reader.js"],"sourcesContent":["var _ = require(\"underscore\");\n\nvar promises = require(\"../promises\");\nvar xml = require(\"../xml\");\n\n\nexports.read = read;\nexports.readXmlFromZipFile = readXmlFromZipFile;\n\nvar xmlNamespaceMap = {\n    \"http://schemas.openxmlformats.org/wordprocessingml/2006/main\": \"w\",\n    \"http://schemas.openxmlformats.org/officeDocument/2006/relationships\": \"r\",\n    \"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\": \"wp\",\n    \"http://schemas.openxmlformats.org/drawingml/2006/main\": \"a\",\n    \"http://schemas.openxmlformats.org/drawingml/2006/picture\": \"pic\",\n    \"http://schemas.openxmlformats.org/package/2006/content-types\": \"content-types\",\n    \"urn:schemas-microsoft-com:vml\": \"v\",\n    \"http://schemas.openxmlformats.org/markup-compatibility/2006\": \"mc\",\n    \"urn:schemas-microsoft-com:office:word\": \"office-word\"\n};\n\n\nfunction read(xmlString) {\n    return xml.readString(xmlString, xmlNamespaceMap)\n        .then(function(document) {\n            return collapseAlternateContent(document)[0];\n        });\n}\n\n\nfunction readXmlFromZipFile(docxFile, path) {\n    if (docxFile.exists(path)) {\n        return docxFile.read(path, \"utf-8\")\n            .then(stripUtf8Bom)\n            .then(read);\n    } else {\n        return promises.resolve(null);\n    }\n}\n\n\nfunction stripUtf8Bom(xmlString) {\n    return xmlString.replace(/^\\uFEFF/g, '');\n}\n\n\nfunction collapseAlternateContent(node) {\n    if (node.type === \"element\") {\n        if (node.name === \"mc:AlternateContent\") {\n            return node.first(\"mc:Fallback\").children;\n        } else {\n            node.children = _.flatten(node.children.map(collapseAlternateContent, true));\n            return [node];\n        }\n    } else {\n        return [node];\n    }\n}\n"],"mappings":"AAAA,IAAIA,CAAC,GAAGC,OAAO,CAAC,YAAY,CAAC;AAE7B,IAAIC,QAAQ,GAAGD,OAAO,CAAC,aAAa,CAAC;AACrC,IAAIE,GAAG,GAAGF,OAAO,CAAC,QAAQ,CAAC;AAG3BG,OAAO,CAACC,IAAI,GAAGA,IAAI;AACnBD,OAAO,CAACE,kBAAkB,GAAGA,kBAAkB;AAE/C,IAAIC,eAAe,GAAG;EAClB,8DAA8D,EAAE,GAAG;EACnE,qEAAqE,EAAE,GAAG;EAC1E,wEAAwE,EAAE,IAAI;EAC9E,uDAAuD,EAAE,GAAG;EAC5D,0DAA0D,EAAE,KAAK;EACjE,8DAA8D,EAAE,eAAe;EAC/E,+BAA+B,EAAE,GAAG;EACpC,6DAA6D,EAAE,IAAI;EACnE,uCAAuC,EAAE;AAC7C,CAAC;AAGD,SAASF,IAAIA,CAACG,SAAS,EAAE;EACrB,OAAOL,GAAG,CAACM,UAAU,CAACD,SAAS,EAAED,eAAe,CAAC,CAC5CG,IAAI,CAAC,UAASC,QAAQ,EAAE;IACrB,OAAOC,wBAAwB,CAACD,QAAQ,CAAC,CAAC,CAAC,CAAC;EAChD,CAAC,CAAC;AACV;AAGA,SAASL,kBAAkBA,CAACO,QAAQ,EAAEC,IAAI,EAAE;EACxC,IAAID,QAAQ,CAACE,MAAM,CAACD,IAAI,CAAC,EAAE;IACvB,OAAOD,QAAQ,CAACR,IAAI,CAACS,IAAI,EAAE,OAAO,CAAC,CAC9BJ,IAAI,CAACM,YAAY,CAAC,CAClBN,IAAI,CAACL,IAAI,CAAC;EACnB,CAAC,MAAM;IACH,OAAOH,QAAQ,CAACe,OAAO,CAAC,IAAI,CAAC;EACjC;AACJ;AAGA,SAASD,YAAYA,CAACR,SAAS,EAAE;EAC7B,OAAOA,SAAS,CAACU,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC;AAC5C;AAGA,SAASN,wBAAwBA,CAACO,IAAI,EAAE;EACpC,IAAIA,IAAI,CAACC,IAAI,KAAK,SAAS,EAAE;IACzB,IAAID,IAAI,CAACE,IAAI,KAAK,qBAAqB,EAAE;MACrC,OAAOF,IAAI,CAACG,KAAK,CAAC,aAAa,CAAC,CAACC,QAAQ;IAC7C,CAAC,MAAM;MACHJ,IAAI,CAACI,QAAQ,GAAGvB,CAAC,CAACwB,OAAO,CAACL,IAAI,CAACI,QAAQ,CAACE,GAAG,CAACb,wBAAwB,EAAE,IAAI,CAAC,CAAC;MAC5E,OAAO,CAACO,IAAI,CAAC;IACjB;EACJ,CAAC,MAAM;IACH,OAAO,CAACA,IAAI,CAAC;EACjB;AACJ"},"metadata":{},"sourceType":"script","externalDependencies":[]}